# Requirements Archive: v2.3 Extra Features Batch 7 (Monster Overhaul)

**Archived:** 2026-01-25
**Status:** ✅ SHIPPED

This is the archived requirements specification for v2.3.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

## Functional Requirements

### FR-01: Monster Speed Increase
[x] All hostile mobs move 20% faster.

**Exceptions:**
- Creepers (unchanged speed)
- Baby zombies (normalized to adult speed, not boosted)

**Outcome:** Implemented via ENTITY_LOAD attribute modifier. Zombies visibly outpace creepers.

---

### FR-02: Monster Loot Removal
[x] Monsters never drop armor or weapons.

**Outcome:** Extended removedItems set in THC.kt with all armor and weapon types.

---

### FR-03: Zombie -> Husk Replacement
[x] All natural zombie spawns produce husks instead.

**Exceptions:**
- Structure spawns (dungeons, etc.) use vanilla pools
- Spider jockeys preserved (passenger check)

**Outcome:** SpawnReplacementMixin intercepts NaturalSpawner spawn calls.

---

### FR-04: Baby Zombie Speed Normalization
[x] Baby zombies move at the same speed as adult zombies (not 1.5x faster).

**Outcome:** Counter-modifier (-0.5) negates vanilla BABY_SPEED_BONUS.

---

### FR-05: Zombie Iron Drop Removal
[x] Zombies (and husks) no longer drop iron ingots.

**Outcome:** Added Items.IRON_INGOT to removedItems loot filter.

---

### FR-06: Skeleton -> Stray Replacement
[x] All natural skeleton spawns produce strays instead.

**Exceptions:**
- Structure spawns (dungeons, etc.) use vanilla pools
- Spider jockeys keep skeleton riders

**Outcome:** Same SpawnReplacementMixin handles skeleton replacement.

---

### FR-07: Ghast Projectile Speed
[x] Ghast fireballs travel 50% faster.

**Outcome:** GhastModifications.kt scales LargeFireball velocity via ENTITY_LOAD.

---

### FR-08: Ghast Fire Rate
[x] Ghasts fire 25% less frequently (every 4 seconds instead of 3).

**Outcome:** @ModifyConstant on GhastShootFireballGoal changes chargeTime reset from -40 to -60.

---

### FR-09: Ghast Explosion Radius
[x] Ghast fireball explosions have 100% larger fire spread radius.

**Outcome:** LargeFireballMixin TAIL inject on onHit places fire in 3-6 block ring.

---

### FR-10: Enderman Teleport-Behind
[x] Endermen have 50% chance to teleport 3 blocks behind the player after damage exchange.

**Outcome:** EndermanMixin RETURN inject on hurtServer with random.nextBoolean() check.

---

### FR-11: Enderman Proximity Aggro
[x] Endermen aggro if player is within 3 blocks (regardless of eye contact).

**Outcome:** EndermanProximityAggroGoal injected via MobRegisterGoalsMixin.

---

### FR-12: Vex Health Reduction
[x] Vex health reduced to 4 hearts (from 14).

**Outcome:** SimpleEntityBehaviors modifies base value via ENTITY_LOAD.

---

### FR-13: Vex Sword Removal
[x] Vexes no longer spawn with iron swords.

**Outcome:** SimpleEntityBehaviors clears mainhand slot via ENTITY_LOAD.

---

### FR-14: Phantom Natural Spawn Removal
[x] Phantoms no longer spawn naturally from insomnia.

**Outcome:** PhantomSpawnerMixin HEAD cancellation returning 0.

---

### FR-15: Illager Patrol Stage-Gating
[x] Illager patrols only spawn when server is at stage 2 or above.

**Outcome:** PatrolSpawnerMixin HEAD cancellation when StageManager.getCurrentStage() < 2.

---

### FR-16: Damage Rebalancing
[x] Six mobs have damage values adjusted:

| Mob | Old Damage | New Damage | Outcome |
|-----|------------|------------|---------|
| Vex | 13.5 | 4 | ATTACK_DAMAGE modifier |
| Vindicator | 19.5 | 11.7 | ATTACK_DAMAGE modifier |
| Evoker (fangs) | 6 | 2.5 | EvokerFangsMixin @ModifyArg |
| Blaze (fireball) | 7.5 | 3.8 | SmallFireballMixin @ModifyArg |
| Piglin (arrow) | 4 | 8 | PiglinCrossbowMixin TAIL inject |
| Magma cube (large) | 9 | 4.7 | ATTACK_DAMAGE modifier |

**Note:** Ghast fireball damage change (9->9.3) removed from scope per CONTEXT.md.

---

### FR-17: Iron Golem Summon Prevention
[x] Players cannot summon iron golems using the pumpkin + iron block pattern.

**Outcome:** CarvedPumpkinBlockMixin HEAD cancellation on trySpawnGolem.

---

### FR-18: Regional Spawn System (Overworld)
[x] Natural monster spawning uses region-based selection:

**Regions:**
- **OW_SURFACE:** At or above heightmap (regardless of sky visibility)
- **OW_UPPER_CAVE:** Y >= 0, below heightmap
- **OW_LOWER_CAVE:** Y < 0, below heightmap

**Outcome:** RegionDetector utility with heightmap-based detection.

---

### FR-19: Custom Mob Distributions
[x] Weighted random distributions per region:

**OW_SURFACE:** 5% witch, 95% vanilla fallback
**OW_UPPER_CAVE:** 5% witch, 2% vex, 10% ranged pillager, 25% melee pillager, 58% vanilla
**OW_LOWER_CAVE:** 8% blaze, 8% breeze, 12% vindicator, 25% melee pillager, 2% evoker, 45% vanilla

**Outcome:** SpawnDistributions.java with weighted random selection.

---

### FR-20: Pillager Variants
[x] MELEE pillager spawns with iron sword, RANGED keeps crossbow.

**Outcome:** PillagerVariant enum with equipment application after finalizeSpawn.

---

### FR-21: Custom Pack Sizes
[x] Mobs spawned via custom distribution use pack size [1, 4].

**Outcome:** SpawnReplacementMixin spawns 1 + random.nextInt(4) members.

---

### FR-22: Partitioned Monster Caps
[x] Regional caps (multipliers of vanilla cap):
- OW_SURFACE_CAP: 30% of vanilla (21 mobs)
- OW_UPPER_CAVE_CAP: 40% of vanilla (28 mobs)
- OW_LOWER_CAVE_CAP: 50% of vanilla (35 mobs)

Total: 120% (intentional overlap)

**Outcome:** RegionalCapManager utility with ThreadLocal spawn cycle tracking.

---

### FR-23: NBT Spawn Origin Tagging
[x] All spawned entities receive NBT tags:
- `spawnSystem.region`: String enum
- `spawnSystem.counted`: Boolean

**Outcome:** MobFinalizeSpawnMixin sets attachments on TAIL inject.

---

## Non-Functional Requirements

### NFR-01: Performance
[x] Regional detection <0.1ms per spawn attempt.

**Outcome:** Single heightmap lookup per spawn position.

---

### NFR-02: Compatibility
[x] No breakage of existing THC systems.

**Outcome:** Base chunk blocking, threat system, parry stun all verified working.

---

### NFR-03: Testability
[x] Each feature verifiable via in-game observation.

**Outcome:** All acceptance criteria achievable through gameplay.

---

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| FR-01 | Phase 37 | ✅ Complete |
| FR-02 | Phase 37 | ✅ Complete |
| FR-03 | Phase 38 | ✅ Complete |
| FR-04 | Phase 37 | ✅ Complete |
| FR-05 | Phase 37 | ✅ Complete |
| FR-06 | Phase 38 | ✅ Complete |
| FR-07 | Phase 40 | ✅ Complete |
| FR-08 | Phase 40 | ✅ Complete |
| FR-09 | Phase 40 | ✅ Complete |
| FR-10 | Phase 40 | ✅ Complete |
| FR-11 | Phase 40 | ✅ Complete |
| FR-12 | Phase 39 | ✅ Complete |
| FR-13 | Phase 39 | ✅ Complete |
| FR-14 | Phase 39 | ✅ Complete |
| FR-15 | Phase 39 | ✅ Complete |
| FR-16 | Phase 44 | ✅ Complete |
| FR-17 | Phase 39 | ✅ Complete |
| FR-18 | Phase 42 | ✅ Complete |
| FR-19 | Phase 42 | ✅ Complete |
| FR-20 | Phase 42 | ✅ Complete |
| FR-21 | Phase 42 | ✅ Complete |
| FR-22 | Phase 43 | ✅ Complete |
| FR-23 | Phase 41 | ✅ Complete |

---

## Milestone Summary

**Shipped:** 23 of 23 requirements
**Adjusted:** None
**Dropped:** FR-16 Ghast damage (9→9.3) removed from scope as trivial change

---

*Archived: 2026-01-25 as part of v2.3 milestone completion*
