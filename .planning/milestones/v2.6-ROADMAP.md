# Milestone v2.6: Extra Features Batch 10

**Status:** SHIPPED 2026-01-29
**Phases:** 57-61
**Total Plans:** 7

## Overview

Quality-of-life improvements across combat, crafting, and world interaction — soul economy expansion, threat system refinement, smithing progression overhaul.

## Phases

### Phase 57: Soul Economy & Combat Tuning

**Goal:** Implement soul dust drops from illagers, soul soil crafting, and combat balance tweaks (arrow speed, melee pillager damage)
**Depends on:** 55-enchanting-system, 53-illager-spawns
**Plans:** 1 plan

Plans:
- [x] 57-01: Soul dust drops, soul soil recipe, arrow Speed III, melee pillager damage 6.5

**Details:**
- All 6 illager types drop soul dust at 20% (+1% Looting)
- 4 soul dust crafts 1 soul soil in 2x2 pattern
- Arrow Speed effect reduced from IV to III
- Melee pillagers deal 6.5 damage (was ~4.5)

---

### Phase 58: Mining Fatigue Exemptions

**Goal:** Expand mining fatigue exemptions to include flowers, grass, glass, beds, ores, and gravel; guarantee flint from shovel-mined gravel
**Depends on:** Phase 05 (WorldRestrictions.ALLOWED_BLOCKS)
**Plans:** 1 plan

Plans:
- [x] 58-01: Mining fatigue exemptions + gravel flint loot table

**Details:**
- Gravel loot table override guarantees flint when broken with any shovel
- Mining fatigue exempts flowers (17+ variants via BlockTags.FLOWERS)
- Mining fatigue exempts grass/dirt blocks (via BlockTags.DIRT)
- Mining fatigue exempts all glass variants (via BlockTags.IMPERMEABLE)
- Mining fatigue exempts all bed colors (via BlockTags.BEDS)
- Mining fatigue exempts all placeable-anywhere blocks (via WorldRestrictions.ALLOWED_BLOCKS)

---

### Phase 59: Spawn Distribution & Proximity Threat

**Goal:** Add wither skeletons to deepslate spawn pool at 15%; implement proximity threat (ceil(X/4) to mobs within 5 blocks when dealing damage)
**Depends on:** 57-01, 53-03
**Plans:** 1 plan

Plans:
- [x] 59-01: Wither skeleton spawns + player-centered proximity threat

**Details:**
- Wither skeletons added to deepslate spawn pool at 15% weight
- Deepslate pillager weight reduced from 25% to 20%
- Deepslate vanilla fallback reduced from 45% to 35%
- Dealing X damage adds ceil(X/4) threat to mobs within 5 blocks of player
- Direct damage target excluded from proximity threat (no double threat)

---

### Phase 60: Village Deregistration

**Goal:** Prevent village mechanics in claimed chunks by blocking POI registration and villager memory claiming
**Depends on:** Phase 25 (ClaimManager.isClaimed)
**Plans:** 1 plan

Plans:
- [x] 60-01: POI registration blocking + villager memory filtering

**Details:**
- ServerLevelPoiMixin blocks POI registration for beds/workstations/bells in claimed chunks
- BrainPoiMemoryMixin blocks villager memories of POI in claimed chunks
- ServerHolder singleton provides server access for Brain mixin
- Two-layer defense: blocks new POI + catches pre-existing POI

---

### Phase 61: Smithing Table Tier Upgrades

**Goal:** Implement smithing table tier upgrades for armor (leather→copper→iron→diamond) and tools (wooden→stone→copper→iron→diamond) with enchantment preservation
**Depends on:** 56-copper-overhaul
**Plans:** 3 plans

Plans:
- [x] 61-01: SmithingMenuMixin, TierUpgradeConfig, armor tier upgrade recipes
- [x] 61-02: Tool tier upgrade recipes and material mappings
- [x] 61-03: Copper smithing table alternative recipe

**Details:**
- SmithingMenuMixin intercepts tier upgrades with material count validation
- TierUpgradeConfig defines valid upgrade paths and material counts
- Armor upgrades: leather→copper (5/8/7/4), copper→iron (5/8/7/4), iron→diamond (5/8/7/4)
- Tool upgrades: wooden→stone (smooth stone), stone→copper, copper→iron, iron→diamond
- All enchantments preserved via applyComponents()
- Durability restored to maximum via remove(DataComponents.DAMAGE)
- Barrier block as dummy template (mixin bypasses template requirement)
- Diamond→netherite unchanged (vanilla passthrough)
- Alternative copper smithing table recipe (thc:smithing_table_copper)

---

## Milestone Summary

**Decimal Phases:** None

**Key Decisions:**

| ID | Decision | Rationale |
|----|----------|-----------|
| SOUL-LOOT-01 | Flat +1% Looting bonus | Matches v2.5 blaze pattern |
| SOUL-CRAFT-01 | 2x2 recipe (4 dust -> 1 soil) | Accessible but not trivial |
| CMBT-ARROW-01 | Arrow Speed III | Reduces kiting effectiveness |
| CMBT-PILLAGER-01 | Equipment-based damage modifier | Iron sword check for melee detection |
| WRLD-EXEMPT-01 | BlockTags for exempt categories | Auto-covers all variants |
| SPAWN-WITHER-01 | 15% wither skeleton weight | Meaningful but not dominant |
| THRT-PROX-01 | 5 block radius centered on player | Tactical awareness zone |
| THRT-CALC-01 | ceil(damage/4) for proximity threat | Scales with damage, prevents instant aggro |
| VILL-POI-01 | Intercept ServerLevel.updatePOIOnBlockStateChange | PoiManager lacks server access |
| VILL-BRAIN-01 | ServerHolder singleton | Brain lacks owner reference |
| VILL-MEMORY-01 | Filter POI memory types | Prevents over-blocking |
| SMTH-BARRIER-01 | Barrier block as dummy template | Mixin bypasses template requirement |
| SMTH-COUNT-01 | Material counts match crafting | Intuitive upgrade costs |
| SMTH-COMPONENT-01 | applyComponents() for enchantment preservation | Preserves all data while resetting durability |
| SMTH-TOOL-01 | Smooth stone for wooden→stone | Available early game |

**Issues Resolved:**

- Village mechanics interfering with claimed base chunks
- Mining fatigue blocking useful blocks (flowers, beds, glass)
- No upgrade path for copper/iron armor and tools
- Threat system only affected direct targets

**Issues Deferred:** None

**Technical Debt Incurred:** None

---

_For current project status, see .planning/ROADMAP.md_
