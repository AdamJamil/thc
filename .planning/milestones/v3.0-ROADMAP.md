# Milestone v3.0: Revival System

**Status:** SHIPPED 2026-02-02
**Phases:** 72-74
**Total Plans:** 4

## Overview

Replace instant death with downed state and cooperative revival mechanic. Players enter spectator mode when HP reaches 0, tethered near their death location, and can be revived by teammates sneaking nearby.

## Phases

### Phase 72: Core Downed State

**Goal**: Intercept death to enter downed state with spectator mode and tether
**Depends on**: None (new subsystem)
**Plans**: 1 plan

Plans:
- [x] 72-01: Core Downed State (attachment, death interception, tether)

**Details:**
- DOWNED_LOCATION attachment (non-persistent Vec3)
- Fabric API ALLOW_DEATH event for death interception
- Spectator mode for invulnerability and mob AI exclusion
- 50-block tether enforcement via server tick hook

### Phase 73: Revival Mechanics

**Goal**: Implement revival progress and completion logic
**Depends on**: Phase 72 (downed state)
**Plans**: 2 plans

Plans:
- [x] 73-01: Revival Progress System (attachment, tick processor, class bonus)
- [x] 73-02: Revival Completion (state restoration, particles)

**Details:**
- REVIVAL_PROGRESS attachment (0.0 to 1.0)
- Progress accumulation: 0.5/tick (Support: 1.0/tick)
- Proximity check: 2 blocks, requires sneaking
- Multi-reviver stacking naturally supported
- Revival completion: survival mode, 50% HP, 6 hunger
- Green HAPPY_VILLAGER particles on completion

### Phase 74: Revival UI

**Goal**: Client-side progress visualization
**Depends on**: Phase 73 (revival progress)
**Plans**: 1 plan

Plans:
- [x] 74-01: Revival Progress UI (sync, renderer, HUD)

**Details:**
- RevivalStatePayload syncs downed UUID, location, progress
- 60-degree look cone for target detection
- Radial progress ring centered on cursor
- Vertical fill (top-down) instead of radial due to MC API changes

---

## Milestone Summary

**Decimal Phases:**
- None (no urgent insertions needed)

**Key Decisions:**
- Fabric API event over mixin for death interception (more stable)
- Vec3 over BlockPos for downed location (sub-block precision)
- Non-persistent attachments (downed state should not survive restart)
- Squared distance checks for performance
- clearDowned cascades to clear revival progress
- Separate completion pass in tick processor (avoids concurrent modification)
- 60-degree look cone (cos(60) = 0.5 dot product)
- Vertical fill instead of radial pie (MC 1.21.x API limitations)

**Issues Resolved:**
- Death interception without breaking vanilla death logic
- Multi-reviver support through natural addProgress stacking
- Look direction detection for revival target

**Issues Deferred:**
- Radial pie fill for progress ring (using vertical fill instead)
- Bleedout timer (user specified indefinite downed duration)
- Downed player indicator visible through walls

**Technical Debt Incurred:**
- Revival progress ring uses vertical fill instead of radial - can be enhanced later

---

_For current project status, see .planning/ROADMAP.md_
