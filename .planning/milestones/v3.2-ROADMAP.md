# Milestone v3.2: Effects GUI

**Status:** In Progress
**Phases:** 80-82
**Total Plans:** TBD

## Overview

Client-side HUD displaying active status effects in the bottom-left corner with priority sorting, layered frame rendering (frame + scaled icon + duration overlay + roman numeral), smooth per-tick duration tracking, and configurable scaling via Video Settings. Three phases: core rendering with positioning and sorting, dynamic overlays with lifecycle behavior, and scaling settings integration.

## Phases

### Phase 80: Core HUD Rendering

**Goal**: Player sees active effects displayed in the bottom-left corner with frames, icons, and priority sorting
**Depends on**: None
**Requirements**: HUD-01, HUD-02, HUD-03, FRAM-01, FRAM-02
**Plans:** 1 plan

Plans:
- [ ] 80-01-PLAN.md — Effects HUD renderer with priority sorting and frame+icon layout

**Success Criteria:**
1. Player with active status effects sees them rendered in the bottom-left corner of the screen
2. Multiple effects stack vertically upward with no gaps between frames
3. Each effect displays inside a 44x44 frame using effect_frame.png
4. Vanilla mob effect icon appears at 2x scale (36x36) centered inside the frame
5. Effects appear in priority order: Wither first (bottom), then Poison, Resistance, Absorption, Strength, Slowness, Weakness, Speed, then all others

**Details:**
- Fabric HUD render event registration
- Effect collection from local player each frame
- Priority comparator for sorting (hardcoded priority list + fallback)
- Frame texture rendering at scaled resolution
- Vanilla MobEffect sprite extraction and 2x scaling
- Vertical stacking with zero-gap layout from bottom-left anchor

---

### Phase 81: Duration Overlay and Numerals

**Goal**: Effects show remaining duration as a green overlay and amplifier level as a roman numeral
**Depends on**: Phase 80 (frame rendering exists)
**Requirements**: FRAM-03, FRAM-04, LIFE-01, LIFE-02
**Plans:** 1 plan

Plans:
- [ ] 81-01-PLAN.md — Duration overlay and roman numeral rendering

**Success Criteria:**
1. Green 50% transparent overlay fills from the bottom of the effect icon, proportional to remaining duration
2. Duration overlay updates smoothly every tick (no visible stepping)
3. Roman numeral (I-X) appears at 5px right, 5px down from top-left corner of the frame
4. Effects appear instantly when applied and disappear instantly when expired or removed

**Details:**
- Duration tracking: remaining ticks vs original duration ratio
- Green overlay rendering with alpha=0.5, height proportional to duration percentage
- Numeral spritesheet (numeral.png, 13x9 subsections) rendering
- Amplifier-to-numeral mapping (0=I, 1=II, ..., 9=X)
- Per-tick interpolation for smooth drain visual

---

### Phase 82: Scaling Settings

**Goal**: Player can configure Effects GUI size through Video Settings
**Depends on**: Phase 80 (rendering exists to scale)
**Requirements**: SCAL-01, SCAL-02
**Plans:** TBD

Plans:
- [ ] 82-01-PLAN.md — TBD

**Success Criteria:**
1. Video Settings menu contains an "Effects GUI Scaling" slider option
2. Slider adjusts frame width from 2% to 20% of screen width
3. All HUD elements (frame, icon, overlay, numeral) scale proportionally with the setting

**Details:**
- Fabric client config or custom option integration
- Video Settings screen mixin to add slider widget
- Scale factor computation: frame_width = screen_width * percentage
- All render coordinates and sizes derived from scale factor

---

## Coverage Validation

| Category | Requirements | Phase | Count |
|----------|--------------|-------|-------|
| HUD | HUD-01, HUD-02, HUD-03 | 80 | 3 |
| FRAM | FRAM-01, FRAM-02 | 80 | 2 |
| FRAM | FRAM-03, FRAM-04 | 81 | 2 |
| LIFE | LIFE-01, LIFE-02 | 81 | 2 |
| SCAL | SCAL-01, SCAL-02 | 82 | 2 |

**Total:** 11/11 requirements mapped (100% coverage)

---

## Milestone Summary

**Key Dependencies:**
- Phase 80 must complete first (establishes HUD rendering infrastructure)
- Phase 81 depends on 80 (adds overlays to existing frames)
- Phase 82 depends on 80 (scales existing rendering)
- Phases 81 and 82 are independent of each other but both need 80

**Risk Areas:**
- Vanilla MobEffect sprite access may require mixin or accessor for internal texture atlas
- Per-tick duration tracking needs access to effect duration/amplifier which may not be directly exposed on client
- Video Settings integration approach varies by Fabric API version

---

_Created: 2026-02-09_
