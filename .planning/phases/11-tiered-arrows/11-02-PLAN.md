---
phase: 11-tiered-arrows
plan: 02
type: execute
wave: 2
depends_on: ["11-01"]
files_modified:
  - src/main/kotlin/thc/item/TieredArrowItem.kt
  - src/main/kotlin/thc/item/THCArrows.kt
  - src/main/kotlin/thc/THC.kt
  - src/main/resources/assets/thc/lang/en_us.json
  - src/main/resources/assets/thc/items/iron_arrow.json
  - src/main/resources/assets/thc/items/diamond_arrow.json
  - src/main/resources/assets/thc/items/netherite_arrow.json
  - src/main/resources/assets/thc/models/item/iron_arrow.json
  - src/main/resources/assets/thc/models/item/diamond_arrow.json
  - src/main/resources/assets/thc/models/item/netherite_arrow.json
autonomous: true

must_haves:
  truths:
    - "Iron Arrow exists as craftable item in game"
    - "Diamond Arrow exists as craftable item in game"
    - "Netherite Arrow exists as craftable item in game"
    - "Iron Arrow deals +1 base damage when shot"
    - "Diamond Arrow deals +2 base damage when shot"
    - "Netherite Arrow deals +3 base damage when shot"
    - "Each tiered arrow displays correct texture"
  artifacts:
    - path: "src/main/kotlin/thc/item/TieredArrowItem.kt"
      provides: "Arrow item class with damage bonus"
      min_lines: 15
    - path: "src/main/kotlin/thc/item/THCArrows.kt"
      provides: "Arrow item registration"
      contains: "IRON_ARROW"
    - path: "src/main/resources/assets/thc/items/iron_arrow.json"
      provides: "Iron arrow item definition"
    - path: "src/main/resources/assets/thc/items/diamond_arrow.json"
      provides: "Diamond arrow item definition"
    - path: "src/main/resources/assets/thc/items/netherite_arrow.json"
      provides: "Netherite arrow item definition"
  key_links:
    - from: "TieredArrowItem.createArrow()"
      to: "arrow.setBaseDamage()"
      via: "damage bonus applied on arrow creation"
      pattern: "setBaseDamage"
    - from: "THCArrows"
      to: "THC.onInitialize()"
      via: "init() call"
      pattern: "THCArrows.init"
---

<objective>
Create tiered arrow items (Iron, Diamond, Netherite) with damage bonuses.

Purpose: Provide ranged combat progression through tiered arrows with increasing damage.
Output: Three new arrow items registered with correct damage values and assets.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/main/kotlin/thc/item/THCBucklers.kt
@src/main/kotlin/thc/item/THCItems.kt
@src/main/kotlin/thc/THC.kt
@src/main/resources/assets/thc/lang/en_us.json
@src/main/resources/assets/thc/items/iron_buckler.json
@src/main/resources/assets/thc/models/item/iron_buckler.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TieredArrowItem class with damage bonus</name>
  <files>src/main/kotlin/thc/item/TieredArrowItem.kt</files>
  <action>
    Create TieredArrowItem extending ArrowItem:
    ```kotlin
    package thc.item

    import net.minecraft.world.entity.LivingEntity
    import net.minecraft.world.entity.projectile.AbstractArrow
    import net.minecraft.world.item.ArrowItem
    import net.minecraft.world.item.ItemStack
    import net.minecraft.world.level.Level

    class TieredArrowItem(
        properties: Properties,
        private val damageBonus: Double
    ) : ArrowItem(properties) {

        override fun createArrow(
            level: Level,
            ammo: ItemStack,
            shooter: LivingEntity,
            weapon: ItemStack?
        ): AbstractArrow {
            val arrow = super.createArrow(level, ammo, shooter, weapon)
            // Add damage bonus to vanilla base damage (2.0)
            arrow.baseDamage = arrow.baseDamage + damageBonus
            return arrow
        }
    }
    ```
    - Extends ArrowItem to inherit bow/crossbow compatibility
    - Takes damageBonus parameter for tier-specific damage
    - Overrides createArrow to apply damage bonus via setBaseDamage()
    - Vanilla arrow base damage is 2.0, so +1/+2/+3 means 3.0/4.0/5.0 total
  </action>
  <verify>./gradlew build succeeds</verify>
  <done>TieredArrowItem class compiles with damage bonus support</done>
</task>

<task type="auto">
  <name>Task 2: Create THCArrows registration object</name>
  <files>src/main/kotlin/thc/item/THCArrows.kt, src/main/kotlin/thc/THC.kt</files>
  <action>
    Create THCArrows following THCBucklers pattern:
    ```kotlin
    package thc.item

    import net.fabricmc.fabric.api.itemgroup.v1.ItemGroupEvents
    import net.minecraft.core.Registry
    import net.minecraft.core.registries.BuiltInRegistries
    import net.minecraft.core.registries.Registries
    import net.minecraft.resources.Identifier
    import net.minecraft.resources.ResourceKey
    import net.minecraft.world.item.CreativeModeTab
    import net.minecraft.world.item.Item

    object THCArrows {
        private val combatTabKey: ResourceKey<CreativeModeTab> = ResourceKey.create(
            Registries.CREATIVE_MODE_TAB,
            Identifier.withDefaultNamespace("combat")
        )

        @JvmField
        val IRON_ARROW: Item = register("iron_arrow") { key ->
            TieredArrowItem(
                Item.Properties().setId(key),
                1.0  // +1 damage
            )
        }

        @JvmField
        val DIAMOND_ARROW: Item = register("diamond_arrow") { key ->
            TieredArrowItem(
                Item.Properties().setId(key),
                2.0  // +2 damage
            )
        }

        @JvmField
        val NETHERITE_ARROW: Item = register("netherite_arrow") { key ->
            TieredArrowItem(
                Item.Properties().setId(key),
                3.0  // +3 damage
            )
        }

        fun init() {
            ItemGroupEvents.modifyEntriesEvent(combatTabKey).register { entries ->
                entries.accept(IRON_ARROW)
                entries.accept(DIAMOND_ARROW)
                entries.accept(NETHERITE_ARROW)
            }
        }

        private fun register(name: String, factory: (ResourceKey<Item>) -> Item): Item {
            val key = ResourceKey.create(Registries.ITEM, Identifier.fromNamespaceAndPath("thc", name))
            val item = factory(key)
            return Registry.register(BuiltInRegistries.ITEM, key, item)
        }
    }
    ```

    Then add THCArrows.init() call to THC.onInitialize():
    - Import thc.item.THCArrows
    - Add THCArrows.init() after THCItems.init()
  </action>
  <verify>./gradlew build succeeds</verify>
  <done>Three arrow items registered: IRON_ARROW, DIAMOND_ARROW, NETHERITE_ARROW</done>
</task>

<task type="auto">
  <name>Task 3: Create arrow item assets (items, models, lang)</name>
  <files>
    src/main/resources/assets/thc/items/iron_arrow.json,
    src/main/resources/assets/thc/items/diamond_arrow.json,
    src/main/resources/assets/thc/items/netherite_arrow.json,
    src/main/resources/assets/thc/models/item/iron_arrow.json,
    src/main/resources/assets/thc/models/item/diamond_arrow.json,
    src/main/resources/assets/thc/models/item/netherite_arrow.json,
    src/main/resources/assets/thc/lang/en_us.json
  </files>
  <action>
    Create item definition files in assets/thc/items/:

    iron_arrow.json:
    ```json
    {
      "model": {
        "type": "minecraft:model",
        "model": "thc:item/iron_arrow"
      }
    }
    ```

    diamond_arrow.json and netherite_arrow.json: Same structure with appropriate model paths.

    Create model files in assets/thc/models/item/:

    iron_arrow.json:
    ```json
    {
      "parent": "minecraft:item/generated",
      "textures": {
        "layer0": "thc:item/iron_arrow"
      }
    }
    ```

    diamond_arrow.json and netherite_arrow.json: Same structure with appropriate texture paths.

    Textures already exist at:
    - src/main/resources/assets/thc/textures/item/iron_arrow.png
    - src/main/resources/assets/thc/textures/item/diamond_arrow.png
    - src/main/resources/assets/thc/textures/item/netherite_arrow.png

    Update lang file to add:
    ```json
    "item.thc.iron_arrow": "Iron Arrow",
    "item.thc.diamond_arrow": "Diamond Arrow",
    "item.thc.netherite_arrow": "Netherite Arrow"
    ```
  </action>
  <verify>./gradlew build succeeds</verify>
  <done>All arrow assets created with correct textures and names</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] ./gradlew build succeeds
- [ ] TieredArrowItem class exists with createArrow override
- [ ] THCArrows registers all three arrow types
- [ ] THC.onInitialize calls THCArrows.init()
- [ ] Item definitions exist for all three arrows
- [ ] Model files point to correct textures
- [ ] Lang file has translations for all arrows
</verification>

<success_criteria>

- All tasks completed
- Build passes
- Three tiered arrow items registered with damage bonuses (+1, +2, +3)
- All arrows appear in creative combat tab
- Each arrow has correct texture and name
</success_criteria>

<output>
After completion, create `.planning/phases/11-tiered-arrows/11-02-SUMMARY.md`
</output>
