---
phase: 19-undead-sun-immunity
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/main/java/thc/mixin/MobSunBurnMixin.java
  - src/main/resources/thc.mixins.json
autonomous: true
must_haves:
  truths:
    - "Zombies survive in daylight without burning"
    - "Skeletons survive in daylight without burning"
    - "Phantoms survive in daylight without burning"
    - "Fire Aspect enchantment still ignites undead"
    - "Lava still damages undead normally"
  artifacts:
    - path: "src/main/java/thc/mixin/MobSunBurnMixin.java"
      provides: "Sun burn prevention for all Mob entities"
      min_lines: 20
      contains: "isSunBurnTick"
  key_links:
    - from: "MobSunBurnMixin"
      to: "Mob.isSunBurnTick()"
      via: "@Inject HEAD cancellation"
      pattern: "cir\\.setReturnValue\\(false\\)"
---

<objective>
Prevent undead mobs (zombies, skeletons, phantoms) from burning in sunlight while preserving fire damage from other sources.

Purpose: Part of twilight hardcore — a perpetually hostile world where undead roam freely regardless of time of day.
Output: Single mixin that intercepts sun burn check for all Mob entities.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/research/ARCHITECTURE.md

# Existing mixin patterns
@src/main/java/thc/mixin/NaturalSpawnerMixin.java
@src/main/resources/thc.mixins.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create MobSunBurnMixin</name>
  <files>src/main/java/thc/mixin/MobSunBurnMixin.java</files>
  <action>
Create mixin that targets `Mob.isSunBurnTick()` to always return false.

Implementation:
- Target class: `net.minecraft.world.entity.Mob`
- Target method: `isSunBurnTick` (no arguments, returns boolean)
- Injection: `@Inject` at HEAD with cancellable = true
- Logic: Set return value to false unconditionally

Follow existing pattern from NaturalSpawnerMixin:
```java
@Inject(method = "isSunBurnTick", at = @At("HEAD"), cancellable = true)
private void thc$preventSunBurn(CallbackInfoReturnable<Boolean> cir) {
    cir.setReturnValue(false);
}
```

Important notes:
- Target `Mob` class, NOT individual undead classes (Zombie, Skeleton, Phantom inherit from Mob)
- This ONLY affects sun burning — fire aspect, lava, and other fire sources use different code paths
- Do NOT override `setRemainingFireTicks` or any other fire methods
  </action>
  <verify>File exists at src/main/java/thc/mixin/MobSunBurnMixin.java with correct package, imports, and mixin annotation</verify>
  <done>MobSunBurnMixin.java created with @Inject on isSunBurnTick returning false</done>
</task>

<task type="auto">
  <name>Task 2: Register mixin and verify build</name>
  <files>src/main/resources/thc.mixins.json</files>
  <action>
Add "MobSunBurnMixin" to the mixins array in thc.mixins.json.

Place it alphabetically in the list (after MobDamageThreatMixin, before MonsterThreatGoalMixin).

After editing, run the gradle build to verify compilation:
```bash
./gradlew build
```
  </action>
  <verify>./gradlew build completes successfully with no errors</verify>
  <done>MobSunBurnMixin registered in thc.mixins.json and build passes</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `./gradlew build` succeeds without errors
- [ ] MobSunBurnMixin.java exists with correct mixin structure
- [ ] thc.mixins.json includes MobSunBurnMixin entry
- [ ] No TypeScript/compilation errors
</verification>

<success_criteria>

- All tasks completed
- Build passes
- Mixin correctly targets Mob.isSunBurnTick with HEAD injection
- Fire damage from other sources (lava, fire aspect) unaffected by this change
</success_criteria>

<output>
After completion, create `.planning/phases/19-undead-sun-immunity/19-01-SUMMARY.md`
</output>
