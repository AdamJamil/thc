---
phase: 61-smithing-table-tier-upgrades
plan: 02
type: execute
wave: 2
depends_on: ["61-01"]
files_modified:
  - src/main/kotlin/thc/smithing/TierUpgradeConfig.kt
  - src/main/resources/data/thc/recipe/wooden_to_stone_pickaxe.json
  - src/main/resources/data/thc/recipe/wooden_to_stone_axe.json
  - src/main/resources/data/thc/recipe/wooden_to_stone_shovel.json
  - src/main/resources/data/thc/recipe/wooden_to_stone_hoe.json
  - src/main/resources/data/thc/recipe/wooden_to_stone_sword.json
  - src/main/resources/data/thc/recipe/stone_to_copper_pickaxe.json
  - src/main/resources/data/thc/recipe/stone_to_copper_axe.json
  - src/main/resources/data/thc/recipe/stone_to_copper_shovel.json
  - src/main/resources/data/thc/recipe/stone_to_copper_hoe.json
  - src/main/resources/data/thc/recipe/stone_to_copper_sword.json
  - src/main/resources/data/thc/recipe/copper_to_iron_pickaxe.json
  - src/main/resources/data/thc/recipe/copper_to_iron_axe.json
  - src/main/resources/data/thc/recipe/copper_to_iron_shovel.json
  - src/main/resources/data/thc/recipe/copper_to_iron_hoe.json
  - src/main/resources/data/thc/recipe/copper_to_iron_sword.json
  - src/main/resources/data/thc/recipe/iron_to_diamond_pickaxe.json
  - src/main/resources/data/thc/recipe/iron_to_diamond_axe.json
  - src/main/resources/data/thc/recipe/iron_to_diamond_shovel.json
  - src/main/resources/data/thc/recipe/iron_to_diamond_hoe.json
  - src/main/resources/data/thc/recipe/iron_to_diamond_sword.json
autonomous: true

must_haves:
  truths:
    - "Wooden tools upgrade to stone at smithing table"
    - "Stone tools upgrade to copper at smithing table"
    - "Copper tools upgrade to iron at smithing table"
    - "Iron tools upgrade to diamond at smithing table"
    - "Tool upgrades require crafting-equivalent material counts"
    - "Enchantments preserved during tool tier upgrade"
    - "Durability restored to maximum after tool upgrade"
  artifacts:
    - path: "src/main/kotlin/thc/smithing/TierUpgradeConfig.kt"
      provides: "Extended with tool material counts and upgrade mappings"
      contains: "TOOL_MATERIAL_COUNTS"
    - path: "src/main/resources/data/thc/recipe/wooden_to_stone_pickaxe.json"
      provides: "Wooden to stone pickaxe smithing recipe"
      contains: "smithing_transform"
    - path: "src/main/resources/data/thc/recipe/stone_to_copper_sword.json"
      provides: "Stone to copper sword smithing recipe"
      contains: "smithing_transform"
  key_links:
    - from: "TierUpgradeConfig.kt"
      to: "SmithingMenuMixin.java"
      via: "tool upgrade validation in existing mixin"
      pattern: "TOOL_MATERIAL_COUNTS"
---

<objective>
Add tool tier upgrade support with recipes for wooden->stone->copper->iron->diamond progression.

Purpose: Complete the tier upgrade system by enabling tool upgrades at smithing tables using the mixin infrastructure from Plan 01.
Output: Working tool tier upgrades for all 5 tool types (pickaxe, axe, shovel, hoe, sword) across 4 upgrade tiers.
</objective>

<execution_context>
@/home/tack/.claude/get-shit-done/workflows/execute-plan.md
@/home/tack/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/61-smithing-table-tier-upgrades/61-01-SUMMARY.md
@.planning/phases/61-smithing-table-tier-upgrades/61-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend TierUpgradeConfig with Tool Mappings</name>
  <files>
    src/main/kotlin/thc/smithing/TierUpgradeConfig.kt
  </files>
  <action>
Extend TierUpgradeConfig.kt with tool upgrade configuration:

Add TOOL_MATERIAL_COUNTS map:
- Pickaxe: 3 (wooden, stone, copper, iron - material count from crafting)
- Axe: 3 (wooden, stone, copper, iron)
- Shovel: 1 (wooden, stone, copper, iron)
- Hoe: 2 (wooden, stone, copper, iron)
- Sword: 2 (wooden, stone, copper, iron)

Add tool upgrade mappings to VALID_TIER_UPGRADES:
- Wooden tools + smooth_stone -> stone tools
- Stone tools + copper_ingot -> copper tools
- Copper tools + iron_ingot -> iron tools
- Iron tools + diamond -> diamond tools

For each tool type (pickaxe, axe, shovel, hoe, sword):
- WOODEN_{TOOL} + SMOOTH_STONE -> STONE_{TOOL}
- STONE_{TOOL} + COPPER_INGOT -> COPPER_{TOOL}
- COPPER_{TOOL} + IRON_INGOT -> IRON_{TOOL}
- IRON_{TOOL} + DIAMOND -> DIAMOND_{TOOL}

Update getRequiredMaterialCount() to check both ARMOR_MATERIAL_COUNTS and TOOL_MATERIAL_COUNTS.

Note: Wooden->Stone uses SMOOTH_STONE (not cobblestone) per research recommendation for crafting-equivalent feel.
  </action>
  <verify>
Run `./gradlew build` - compilation succeeds with extended config.
  </verify>
  <done>
TierUpgradeConfig includes tool material counts and all tool upgrade mappings.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Tool Tier Upgrade Recipes</name>
  <files>
    src/main/resources/data/thc/recipe/wooden_to_stone_pickaxe.json
    src/main/resources/data/thc/recipe/wooden_to_stone_axe.json
    src/main/resources/data/thc/recipe/wooden_to_stone_shovel.json
    src/main/resources/data/thc/recipe/wooden_to_stone_hoe.json
    src/main/resources/data/thc/recipe/wooden_to_stone_sword.json
    src/main/resources/data/thc/recipe/stone_to_copper_pickaxe.json
    src/main/resources/data/thc/recipe/stone_to_copper_axe.json
    src/main/resources/data/thc/recipe/stone_to_copper_shovel.json
    src/main/resources/data/thc/recipe/stone_to_copper_hoe.json
    src/main/resources/data/thc/recipe/stone_to_copper_sword.json
    src/main/resources/data/thc/recipe/copper_to_iron_pickaxe.json
    src/main/resources/data/thc/recipe/copper_to_iron_axe.json
    src/main/resources/data/thc/recipe/copper_to_iron_shovel.json
    src/main/resources/data/thc/recipe/copper_to_iron_hoe.json
    src/main/resources/data/thc/recipe/copper_to_iron_sword.json
    src/main/resources/data/thc/recipe/iron_to_diamond_pickaxe.json
    src/main/resources/data/thc/recipe/iron_to_diamond_axe.json
    src/main/resources/data/thc/recipe/iron_to_diamond_shovel.json
    src/main/resources/data/thc/recipe/iron_to_diamond_hoe.json
    src/main/resources/data/thc/recipe/iron_to_diamond_sword.json
  </files>
  <action>
Create 20 smithing_transform recipes in src/main/resources/data/thc/recipe/:

Wooden -> Stone (using smooth_stone):
- wooden_to_stone_pickaxe.json: wooden_pickaxe + smooth_stone -> stone_pickaxe
- wooden_to_stone_axe.json: wooden_axe + smooth_stone -> stone_axe
- wooden_to_stone_shovel.json: wooden_shovel + smooth_stone -> stone_shovel
- wooden_to_stone_hoe.json: wooden_hoe + smooth_stone -> stone_hoe
- wooden_to_stone_sword.json: wooden_sword + smooth_stone -> stone_sword

Stone -> Copper (using copper_ingot):
- stone_to_copper_pickaxe.json: stone_pickaxe + copper_ingot -> copper_pickaxe
- stone_to_copper_axe.json: stone_axe + copper_ingot -> copper_axe
- stone_to_copper_shovel.json: stone_shovel + copper_ingot -> copper_shovel
- stone_to_copper_hoe.json: stone_hoe + copper_ingot -> copper_hoe
- stone_to_copper_sword.json: stone_sword + copper_ingot -> copper_sword

Copper -> Iron (using iron_ingot):
- copper_to_iron_pickaxe.json: copper_pickaxe + iron_ingot -> iron_pickaxe
- copper_to_iron_axe.json: copper_axe + iron_ingot -> iron_axe
- copper_to_iron_shovel.json: copper_shovel + iron_ingot -> iron_shovel
- copper_to_iron_hoe.json: copper_hoe + iron_ingot -> iron_hoe
- copper_to_iron_sword.json: copper_sword + iron_ingot -> iron_sword

Iron -> Diamond (using diamond):
- iron_to_diamond_pickaxe.json: iron_pickaxe + diamond -> diamond_pickaxe
- iron_to_diamond_axe.json: iron_axe + diamond -> diamond_axe
- iron_to_diamond_shovel.json: iron_shovel + diamond -> diamond_shovel
- iron_to_diamond_hoe.json: iron_hoe + diamond -> diamond_hoe
- iron_to_diamond_sword.json: iron_sword + diamond -> diamond_sword

Each recipe follows smithing_transform format:
```json
{
  "type": "minecraft:smithing_transform",
  "template": "minecraft:barrier",
  "base": "minecraft:{tier}_{tool}",
  "addition": "minecraft:{material}",
  "result": {
    "id": "minecraft:{next_tier}_{tool}"
  }
}
```

Note: Mixin handles material count validation. Enchantment preservation automatic.
  </action>
  <verify>
Run `./gradlew build` - JSON files are valid and included in JAR.
  </verify>
  <done>
20 tool tier upgrade recipes exist covering wooden->stone->copper->iron->diamond for all 5 tool types.
  </done>
</task>

</tasks>

<verification>
1. `./gradlew build` succeeds
2. TierUpgradeConfig.kt includes TOOL_MATERIAL_COUNTS
3. 20 recipe JSON files exist in data/thc/recipe/
4. All tool types covered (pickaxe, axe, shovel, hoe, sword)
5. All tiers covered (wooden->stone, stone->copper, copper->iron, iron->diamond)
</verification>

<success_criteria>
- SMTH-04: Wooden tools upgrade to stone using smooth stone (recipes + config)
- SMTH-05: Stone tools upgrade to copper using copper ingots (recipes + config)
- SMTH-06: Copper tools upgrade to iron using iron ingots (recipes + config)
- SMTH-07: Iron tools upgrade to diamond using diamonds (recipes + config)
- SMTH-08: Enchantments preserved (automatic via smithing_transform)
- SMTH-09: Durability restored (mixin from Plan 01)
</success_criteria>

<output>
After completion, create `.planning/phases/61-smithing-table-tier-upgrades/61-02-SUMMARY.md`
</output>
